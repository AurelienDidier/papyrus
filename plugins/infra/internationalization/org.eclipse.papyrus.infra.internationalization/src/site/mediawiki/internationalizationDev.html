<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	</head>
	<body>
		<h1 id="Internationalization">Internationalization</h1>
		<p>The internationalization is the way to manage your model with a specific language by labels. Like Eclipse, the internationalization is managed by the 'properties' file which are defined depending language as following (with for example, english language in US country):</p>
		<ul>
			<li>
				<i>modelName</i>
				<b>_en_US.properties</b>
			</li>
			<li>
				<i>modelName</i>
				<b>_en.properties</b>
			</li>
			<li>
				<i>modelName</i>
				<b>.properties</b>
			</li>
		</ul>
		<p>
			<img title="Properties files in Model Explorer" alt="Properties files in Model Explorer" border="1" src="images/PropertiesModelExplorer.png"/>
		</p>
		<h2 id="Plugins">Plugins</h2>
		<p>The plugins for the internationalization are the following:</p>
		<ul>
			<li><code>org.eclipse.papyrus.infra.internationalization</code>: it contains:
				<ul>
					<li>Internationalization Meta-model</li>
					<li>Generated code from the Meta-model</li>
					<li>The model resources for the internationalization entries (key and label of internationalized objects) and internationalization preferences</li>
					<li>Utils classes to manage the labels and the preferences</li>
				</ul>
			</li>
			<li><code>org.eclipse.papyrus.infra.internationalization.edit</code>: contains generated edit code from the Meta-model</li>
			<li><code>org.eclipse.papyrus.infra.internationalization.common</code>: contains all the common classes to manage command modification and some utils for the internationalization preferences. It contains the <code>IInternationalizationEditor</code> interface too which allows to define the editor that can be internationalized.</li>
			<li><code>org.eclipse.papyrus.infra.internationalization.controlmode</code>: contains the needed elements to manage the control mode for the properties and the preferences files</li>
			<li><code>org.eclipse.papyrus.infra.internationalization.ui</code>: contains the needed ui classes especially for the internationalization preferences</li>
			<li><code>org.eclipse.papyrus.infra.internationalization.utils</code>: contains all the needed utils classes to manage the label which can be used to get the diagrams and tables labels</li>
			<li><code>org.eclipse.papyrus.infra.editor.welcome.internationalization</code>: contains the needed classes to manage the preferences in the welcome page</li>
			<li><code>org.eclipse.papyrus.uml.internationalization</code>: contains the UML internationalization model resource which can manage the UML elements in the properties file</li>
			<li><code>org.eclipse.papyrus.uml.internationalization.edit</code>: contains the <code>InternationalizationUMLItemProviderAdapterFactory</code> which define the ItemProvider of UML elements to use the Papyrus getLabel function instead of UML getLabel function</li>
			<li><code>org.eclipse.papyrus.uml.internationalization.utils</code>: contains all the needed utils classes to manage the label which can be used to get the named elements labels</li>
		</ul>
		<h2 id="How_to_use_internationalization">How to use internationalization</h2>
		<p>Instead of name, the label of objects must be displayed in Papyrus.</p>
		<h3 id="How_the_labels_are_managed_in_properties_file">How the labels are managed in properties file</h3>
		<p>Each element which have a label must be written in the properties file like following:</p>
		<ul>
			<li>If this is a diagram: 
				<ul>
					<li>
						<b>_labelDiagram_</b>
						<i>DiagramOwnerQualifiedName</i>
						<b>_label_</b>
						<i>DiagramName</i> 
						<b>=</b> 
						<i>DiagramLabel</i>
					</li>
				</ul>
			</li>
			<li>If this is a table: 
				<ul>
					<li>
						<b>_labelTable_</b>
						<i>TableOwnerQualifiedName</i>
						<b>_label_</b>
						<i>TableName</i> 
						<b>=</b> 
						<i>TableLabel</i>
					</li>
				</ul>
			</li>
			<li>If this is an UML NamedElement: 
				<ul>
					<li>
						<b>_label_</b>
						<i>NamedElementQualifiedName</i> 
						<b>=</b> 
						<i>NamedElementLabel</i>
					</li>
				</ul>
			</li>
		</ul>
		<p>
			<img title="Example of internationalization labels" alt="Example of internationalization labels" border="1" src="images/LabelsInternationalizationExample.png"/>
		</p>
		<h3 id="Infra_.28Diagrams_and_Tables.29">Infra (Diagrams and Tables)</h3>
		<p>For the Diagrams and the Tables, UML is not needed. So to use the internationalization, you just need to:</p>
		<ul>
			<li>add the org.eclipse.papyrus.infra.internationalization.utils dependency</li>
			<li>use methods/functions of <code>LabelInternationalization</code></li>
		</ul>
		<p>The <code>LabelInternationalization</code> class contains the following needed methods/functions:</p>
		<table class="wikitable" border="1">
			<tr>
				<th style="text-align: center;">Method/Function</th>
				<th style="text-align: center;">Parameters</th>
				<th style="text-align: center;">Description</th>
			</tr>
			<tr>
				<th style="font-weight: bold;">getInstance</th>
				<td></td>
				<td>The the instance of LabelInternationalization</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getDiagramLabelWithoutName</th>
				<td>Diagram</td>
				<td>Get the label of the diagram without getting its name if label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getDiagramLabel</th>
				<td>Diagram</td>
				<td>Get the label of the diagram or the name if the diagram label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">setDiagramLabel</th>
				<td>Diagram, String, Locale</td>
				<td>Set the label (in prameter) of the Diagram for the locale needed (if <code>null</code>, the current must be used) without using command</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getSetDiagramLabelCommand</th>
				<td>EditingDomain, Diagram, String, Locale</td>
				<td>Get the command to set the label (in prameter) of the Diagram for the locale needed (if <code>null</code>, the current must be used)</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getTableLabelWithoutName</th>
				<td>Table</td>
				<td>Get the label of the Table without getting its name if label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getTableLabel</th>
				<td>Table</td>
				<td>Get the label of the Table or the name if the Table label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">setDiagramLabel</th>
				<td>Table, String, Locale</td>
				<td>Set the label (in prameter) of the Table for the locale needed (if <code>null</code>, the current must be used) without using command</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getSetTableLabelCommand</th>
				<td>EditingDomain, Table, String, Locale</td>
				<td>Get the command to set the label (in prameter) of the Table for the locale needed (if <code>null</code>, the current must be used)</td>
			</tr>
		</table>
		<h3 id="UML_Named_Elements">UML Named Elements</h3>
		<p>For the UML NamedElement, to use the internationalization, you just need to:</p>
		<ul>
			<li>add the org.eclipse.papyrus.uml.internationalization.utils dependency</li>
			<li>use the <code>UMLLabelInternationalization</code></li>
		</ul>
		<p>The <code>UMLLabelInternationalization</code> class contains following needed methods/functions:</p>
		<table class="wikitable" border="1">
			<tr>
				<th style="text-align: center;">Method/Function</th>
				<th style="text-align: center;">Parameters</th>
				<th style="text-align: center;">Description</th>
			</tr>
			<tr>
				<th style="font-weight: bold;">getInstance</th>
				<td></td>
				<td>The the instance of LabelInternationalization</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getLabelWithoutName</th>
				<td>NamedElement</td>
				<td>Get the label of the NamedElement without getting its name if label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getLabel</th>
				<td>NamedElement</td>
				<td>Get the label of the NamedElement or the name if the NamedElement label is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">setLabel</th>
				<td>NamedElement, String, Locale</td>
				<td>Set the label (in prameter) of the NamedElement for the locale needed (if <code>null</code>, the current must be used) without using command</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getSetLabelCommand</th>
				<td>EditingDomain, NamedElement, String, Locale</td>
				<td>Get the command to set the label (in prameter) of the NamedElement for the locale needed (if <code>null</code>, the current must be used)</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getKeywordWithoutName</th>
				<td>Stereotype</td>
				<td>Get the keyword of the Stereotype without getting its name if keyword is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getKeyword</th>
				<td>Stereotype</td>
				<td>Get the keyword of the Stereotype or the name if the Stereotype keyword is not available</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">setKeyword</th>
				<td>Stereotype, String, Locale</td>
				<td>Set the keyword (in prameter) of the Stereotype for the locale needed (if <code>null</code>, the current must be used) without using command</td>
			</tr>
			<tr>
				<th style="font-weight: bold;">getSetKeywordCommand</th>
				<td>EditingDomain, Stereotype, String, Locale</td>
				<td>Get the command to set the keyword (in prameter) of the Stereotype for the locale needed (if <code>null</code>, the current must be used)</td>
			</tr>
		</table>
		<h2 id="Internationalization_preferences">Internationalization preferences</h2>
		<p>Two preferences are managed in the papyrus model:</p>
		<ul>
			<li>useInternationalization: Boolean to determinate if the internationalization must be used</li>
			<li>language: String to define the selected language for the internationalization</li>
		</ul>
		<p>The preferences are stored as EAnnotation:</p>
		<ul>
			<li>in the notation file in this is a private storage</li>
			<li>in the metadata in this is not a private storage</li>
		</ul>
		<p>
			<img title="Internationalization preferences management" alt="Internationalization preferences management" border="1" src="images/InternationalizationPreferences.png"/>
		</p>
		<p>Those preferences are managed in a <code>PreferenceStore</code> in the activator of org.eclipse.papyrus.infra.internationalization.common plugin.</p>
		<h2 id="Control_mode">Control mode</h2>
		<p>The sub-models are managed with the properties files.
			Indeed, when an object is created as sub-model, the key representing this object or its descendance in the properties files must be moved in sub-properties files corresponding to the controlled object.
			During this sub-model creation, the qualified names of the keys that are moved change, the new qualified names are calculated from the root of the sub-model.</p>
		<h3 id="What_is_it_managed">What is it managed</h3>
		<p>The managed files/objects are:</p>
		<ul>
			<li>The properties files and their keys</li>
			<li>The notation and the internationalization preferences if this is private storage</li>
		</ul>
		<h3 id="How_is_it_managed">How is it managed</h3>
		<p>The <code>org.eclipse.papyrus.infra.internationalization.controlmode</code> manage all the control mode for the internationalization.</p>
		<p>The properties files are managed by:</p>
		<ul>
			<li><code>PropertiesControlParticipant</code> and <code>PropertiesUncontrolParticipant</code> for the participants</li>
			<li><code>CreatePropertiesControlResourceCommand</code> which define the command to create the controlled properties file</li>
			<li><code>RemovePropertiesControlResourceCommand</code> which define the command to delete the controlled properties file</li>
			<li><code>ControlPropertiesCommand</code> which define the command to manage the internationalization entries to move into the controlled properties</li>
		</ul>
		<p>The notation and the internationalization preference storage are managed by:</p>
		<ul>
			<li><code>InternationalizationAnnotationControlParticipant</code> for the participant (uncontrolled is not needed because the parent is priority)</li>
			<li><code>InternationalizationAnnotationCommand</code> which define the command to create the internationalization preference into the controlled notation file</li>
		</ul>
		<h2 id="Specificities">Specificities</h2>
		<h3 id="Loading_properties_resources">Loading properties resources</h3>
		<p>The properties resources are loaded and managed by the <code>UMLInternationalizationModelResource</code> class.
			This <code>UMLInternationalizationModelResource</code> class inherit from <code>InternationalizationModelResource</code> from infra plugins.
			The load is managed as 2 steps:</p>
		<ol>
			<li>Load the file and read the content to create the <code>InternationalizationLibrary</code> with diagrams and tables labels reconciliation with existing diagrams and tables.</li>
			<li>Loop on content to resolve the UML dependencies in properties files to reference the existing UML objects.</li>
		</ol>
		<p>So, after the load, the resolveable properties are managed as UML object, diagram or table as key of <code>InternationalizationLibrary</code></p>
		<h3 id="InternationalizationUMLItemProviderAdapterFactory">InternationalizationUMLItemProviderAdapterFactory</h3>
		<p>The <code>InternationalizationUMLItemProviderAdapterFactory</code> extends <code>UMLItemProviderAdapterFactory</code> and allows to redefine the ItemProvider of UML elements to get the papyrus internationalization getLabel instead of UML getLabel.</p>
		<p>If an ItemProvider of UML element need to be redefined, the ItemProviderAdapterFactory must ihnerit from this class instead of <code>UMLItemProviderAdapterFactory</code>.</p>
		<h3 id="Diagram_and_Table_owner_QualifiedName">Diagram and Table owner QualifiedName</h3>
		<p>The diagrams and the tables are managed in the infra plugins, however, the owner of the diagram or table must be serialized in the properties file by its QualifiedName. So the owner QualifiedName is managed by the class <code>QualifiedNameUtils</code> and calculated manually.</p>
		<h3 id="Editors">Editors</h3>
		<p>The diagrams and tables are managed by the internationalization. To do this, the diagram and table editor must inherit from <code>IInternationalizationEditor</code> which allows to modify part name and refresh the editor with the label.
			If any new editor is comming with internationalization management, this one must ihnerit from <code>IInternationalizationEditor</code> too.</p>
	</body>
</html>